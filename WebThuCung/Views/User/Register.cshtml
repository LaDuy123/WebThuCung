@model WebThuCung.Dto.RegisterDto
@{
    ViewData["Title"] = "Login";
    Layout = "~/Views/Shared/_LayoutUsers.cshtml";
}

<section id="banner" class="py-3" style="background: #F9F3EC;">
    <div class="container">
        <div class="hero-content py-5 my-3">
            <h2 class="display-1 mt-3 mb-0">Account</h2>
            <nav class="breadcrumb">
                <a class="breadcrumb-item nav-link" href="#">Home</a>
                <a class="breadcrumb-item nav-link" href="#">Pages</a>
                <span class="breadcrumb-item active" aria-current="page">Account</span>
            </nav>
        </div>
    </div>
</section>
<section class="login-tabs padding-large">
    <div class="container my-5 py-5">
        <div class="row">
            <div class="tabs-listing">
                <nav>
                    <div class="nav nav-tabs d-flex justify-content-center border-dark-subtle mb-3" id="nav-tab" role="tablist">
                        <a href ="@Url.Action("Login", "User")" class="nav-link mx-3 fs-3 border-bottom border-dark-subtle border-0 text-uppercase active" id="nav-sign-in-tab" data-bs-toggle="tab" data-bs-target="#nav-sign-in" type="button" role="tab" aria-controls="nav-sign-in" aria-selected="true">
                            Log In
                        </button>
                        <a  class="nav-link mx-3 fs-3 border-bottom border-dark-subtle border-0 text-uppercase" id="nav-register-tab" role="button">
                            Sign Up
                        </a>
                       
                    </div>
                </nav>
                <form asp-acti></form>
                <div class="tab-content" id="nav-tabContent">
                    <!-- Sign Up Tab -->
                    <div class="tab-pane fade active show" id="nav-register" role="tabpanel" aria-labelledby="nav-register-tab">
                        <div class="col-lg-8 offset-lg-2 mt-5">
                            <p class="mb-0">Sign-up With Social</p>
                            <hr class="my-1">
                            <div class="row mt-4 mb-5">
                                <div class="d-grid col-md-6 my-2">
                                    <a href="#" class="btn btn-outline-dark btn-lg text-uppercase fs-6 rounded-1 ">
                                        <div class="d-flex flex-wrap justify-content-center">
                                            <iconify-icon icon="ion:logo-google" class="signup-social-icon me-2"></iconify-icon>
                                            <p class="mb-0">Google</p>
                                        </div>
                                    </a>
                                </div>
                                <div class="d-grid col-md-6 my-2">
                                    <a href="#" class="btn btn-outline-dark btn-lg text-uppercase fs-6 rounded-1 ">
                                        <div class="d-flex flex-wrap justify-content-center">
                                            <iconify-icon icon="ion:logo-facebook" class="signup-social-icon me-2"></iconify-icon>
                                            <p class="mb-0">Facebook</p>
                                        </div>
                                    </a>
                                </div>
                            </div>

                            <p class="mb-0">Or Sign-Up With Email</p>
                            <hr class="my-1">

                            <form asp-action="Register" method="post">
                                @Html.AntiForgeryToken()

                                <!-- Validation Summary -->
                                @* <div asp-validation-summary="All" class="text-danger"></div> *@

                                <!-- Username -->
                                <div class="form-input col-lg-12 my-4">
                                    <label asp-for="userCustomer" class="col-form-label">Username</label>
                                    <input asp-for="userCustomer" class="form-control mb-3 p-4" placeholder="Nhập tên đăng nhập" />
                                    <span asp-validation-for="userCustomer" class="text-danger"></span>
                                </div>

                                <!-- Email -->
                                <div class="form-input col-lg-12 my-4">
                                    <label asp-for="Email" class="col-form-label">Email</label>
                                    <input asp-for="Email" class="form-control mb-3 p-4" placeholder="Nhập địa chỉ email của bạn" />
                                    <span asp-validation-for="Email" class="text-danger"></span>
                                </div>

                                <!-- Password -->
                                <div class="form-input col-lg-12 my-4">
                                    <label asp-for="paswordCusstomer" class="col-form-label">Password</label>
                                    <input asp-for="paswordCusstomer" type="password" class="form-control mb-3 p-4" placeholder="Tạo mật khẩu" />
                                    <span asp-validation-for="paswordCusstomer" class="text-danger"></span>
                                </div>

                                <!-- Confirm Password -->
                                <div class="form-input col-lg-12 my-4">
                                    <label asp-for="confirmPassword" class="col-form-label">Confirm Password</label>
                                    <input asp-for="confirmPassword" type="password" class="form-control mb-3 p-4" placeholder="Nhập lại mật khẩu" />
                                    <span asp-validation-for="confirmPassword" class="text-danger"></span>
                                </div>

                                <!-- Full Name -->
                                <div class="form-input col-lg-12 my-4">
                                    <label asp-for="Name" class="col-form-label">Full Name</label>
                                    <input asp-for="Name" class="form-control mb-3 p-4" placeholder="Nhập họ tên" />
                                    <span asp-validation-for="Name" class="text-danger"></span>
                                </div>

                                <!-- Phone -->
                                <div class="form-input col-lg-12 my-4">
                                    <label asp-for="Phone" class="col-form-label">Phone</label>
                                    <input asp-for="Phone" class="form-control mb-3 p-4" placeholder="Nhập số điện thoại" onkeypress="return isNumberKey(event)" />
                                    <span asp-validation-for="Phone" class="text-danger"></span>
                                </div>
                                <div class="form-input col-lg-12 my-4">
                                    <label asp-for="idCountry" class="col-form-label">Country</label>
                                    <select asp-for="idCountry" class="form-control mb-3 p-4" id="countryDropdown">
                                        <option value="">-- Select Country --</option>
                                        @foreach (var country in ViewBag.Countries)
                                        {
                                            <option value="@country.Value">@country.Text</option>
                                        }
                                    </select>
                                    <span asp-validation-for="idCountry" class="text-danger"></span>
                                </div>

                                <!-- City Dropdown -->
                                <div class="form-input col-lg-12 my-4">
                                    <label asp-for="idCity" class="col-form-label">City</label>
                                    <select asp-for="idCity" class="form-control mb-3 p-4" id="cityDropdown">
                                        <option value="">-- Select City --</option>
                                    </select>
                                    <span asp-validation-for="idCity" class="text-danger"></span>
                                </div>

                                <!-- District Dropdown -->
                                <div class="form-input col-lg-12 my-4">
                                    <label asp-for="idDistrict" class="col-form-label">District</label>
                                    <select asp-for="idDistrict" class="form-control mb-3 p-4" id="districtDropdown">
                                        <option value="">-- Select District --</option>
                                    </select>
                                    <span asp-validation-for="idDistrict" class="text-danger"></span>
                                </div>

                                <!-- Ward Dropdown -->
                                <div class="form-input col-lg-12 my-4">
                                    <label asp-for="idWard" class="col-form-label">Ward</label>
                                    <select asp-for="idWard" class="form-control mb-3 p-4" id="wardDropdown">
                                        <option value="">-- Select Ward --</option>
                                    </select>
                                    <span asp-validation-for="idWard" class="text-danger"></span>
                                </div>
                                <div class="form-input col-lg-12 my-4">
                                    <label asp-for="Address" class="col-form-label">Address</label>
                                    <input asp-for="Address" class="form-control mb-3 p-4" placeholder="Nhập địa chỉ" />
                                    <span asp-validation-for="Address" class="text-danger"></span>
                                </div>

                                <!-- Submit Button -->
                                <div class="d-grid my-3">
                                    <button type="submit" class="btn btn-dark btn-lg rounded-1">Register it now</button>
                                </div>

                                <!-- Back to Login -->
                                <p class="text-center mt-3">
                                    <a href="@Url.Action("Login", "User")" class="text-primary fw-bold">Trở về trang đăng nhập</a>
                                </p>
                            </form><!-- End Register Form -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script language='javascript'>

    function isNumberKey(evt) {
        var charCode = (evt.which) ? evt.which : event.keyCode
        if (charCode > 31 && (charCode < 48 || charCode > 57))
            return false;
        return true;
    }

</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    console.log("Cities Data: ", @Html.Raw(Json.Serialize(ViewBag.Cities)));
    console.log("Countries Data: ", @Html.Raw(Json.Serialize(ViewBag.Countries)));


</script>

<script>
    // $(document).ready(function () {
    //     var cities = @Html.Raw(Json.Serialize(ViewBag.Cities));
    //     console.log("Cities: ", cities); // Kiểm tra toàn bộ dữ liệu

    //     $('#countryDropdown').change(function () {
    //         var selectedCountry = $(this).val();
    //         console.log("Selected Country: ", selectedCountry);

    //         // Lọc thành phố dựa trên quốc gia đã chọn
    //         var filteredCities = cities.filter(city => {
             
    //             return city.countryId == selectedCountry; // Sửa lại ở đây
    //         });

    //         console.log("Filtered Cities: ", filteredCities); // Kiểm tra các thành phố đã lọc

    //         $('#cityDropdown').empty().append('<option value="">-- Chọn Thành Phố --</option>');
    //         $.each(filteredCities, function (index, city) {
    //             $('#cityDropdown').append('<option value="' + city.value + '">' + city.text + '</option>'); // Sửa lại ở đây
    //         });

    //         // Xóa các dropdown tiếp theo
    //         $('#districtDropdown').empty().append('<option value="">-- Chọn Quận --</option>');
    //         $('#wardDropdown').empty().append('<option value="">-- Chọn Phường --</option>');
    //     });
    // });

    $(document).ready(function () {
        var cities = @Html.Raw(Json.Serialize(ViewBag.Cities));
        var districts = @Html.Raw(Json.Serialize(ViewBag.Districts));
        var wards = @Html.Raw(Json.Serialize(ViewBag.Wards));

        $('#countryDropdown').change(function () {
            var selectedCountry = $(this).val();
            var filteredCities = cities.filter(city => {

                return city.countryId == selectedCountry; // Sửa lại ở đây
            });

            $('#cityDropdown').empty().append('<option value="">-- Select City --</option>');
            $.each(filteredCities, function (index, city) {
                $('#cityDropdown').append('<option value="' + city.value + '">' + city.text + '</option>');
            });

            // Clear the subsequent dropdowns
            $('#districtDropdown').empty().append('<option value="">-- Select District --</option>');
            $('#wardDropdown').empty().append('<option value="">-- Select Ward --</option>');
        });

        $('#cityDropdown').change(function () {
            var selectedCity = $(this).val();

            // Filter districts based on selected city
         
            var filteredDistricts = districts.filter(district => {

                return district.cityId == selectedCity; // Sửa lại ở đây
            });
            $('#districtDropdown').empty().append('<option value="">-- Select District --</option>');
            $.each(filteredDistricts, function (index, district) {
                $('#districtDropdown').append('<option value="' + district.value + '">' + district.text + '</option>');
            });

            // Clear the ward dropdown
            $('#wardDropdown').empty().append('<option value="">-- Select Ward --</option>');
        });

        $('#districtDropdown').change(function () {
            var selectedDistrict = $(this).val();

            // Filter wards based on selected district
            var filteredWards = wards.filter(ward => {

                return ward.districtId == selectedDistrict; // Sửa lại ở đây
            });
 
            $('#wardDropdown').empty().append('<option value="">-- Select Ward --</option>');
            $.each(filteredWards, function (index, ward) {
                $('#wardDropdown').append('<option value="' + ward.value + '">' + ward.text + '</option>');
            });
        });
    });
</script>
